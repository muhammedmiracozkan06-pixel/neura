<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neura MAX doÄŸrula</title>

<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
:root { --primary:#3b82f6; --bg:#0b0b0e; --card:#16161a; }
body { margin:0; background:var(--bg); color:#fff; font-family:'Segoe UI',sans-serif; overflow:hidden; }

#auth-overlay { position:fixed; inset:0; background:var(--bg); display:flex; align-items:center; justify-content:center; z-index:9999; }
.auth-card { background:var(--card); padding:40px; border-radius:25px; border:1px solid #333; text-align:center; width:320px; box-shadow:0 10px 50px rgba(0,0,0,0.5); }

#main-app { display:none; flex-direction:column; height:100vh; }
#header { padding:15px 25px; background:#111; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #222; }

#chat { flex:1; overflow-y:auto; padding:20px; display:flex; flex-direction:column; gap:15px; }
.msg { padding:14px 18px; border-radius:18px; max-width:75%; font-size:15px; word-wrap:break-word; line-height: 1.4; }
.user { background:var(--primary); align-self:flex-end; border-bottom-right-radius:4px; }
.bot { background:#222; align-self:flex-start; border:1px solid #333; border-bottom-left-radius:4px; }

/* AranÄ±yor yazÄ±sÄ± iÃ§in tatlÄ± bir efekt */
.searching { color: var(--primary); font-style: italic; font-size: 13px; margin-top: -10px; margin-left: 5px; animation: blink 1s infinite; }
@keyframes blink { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

#input-area { padding:20px; display:flex; gap:12px; background:#070709; border-top:1px solid #222; }
input { flex:1; padding:14px; border-radius:12px; border:1px solid #333; background:#1a1a1e; color:#fff; outline:none; }
button { background:var(--primary); border:none; padding:10px 25px; border-radius:12px; color:#fff; font-weight:bold; cursor:pointer; }

.hidden { display:none !important; }
</style>
</head>
<body>

<div id="auth-overlay">
<div class="auth-card">
<h1 style="color:var(--primary); margin-bottom:10px;">Neura MAX</h1>

<div id="captcha-box" style="margin-bottom:20px; display:flex; justify-content:center;">
<div class="g-recaptcha"
     data-sitekey="6Lfumm0sAAAAAIzv9cJMM6Xip9W_Bwgi_aHQ2jnt"
     data-callback="unlock">
</div>
</div>

<div id="login-options" class="hidden">
<p style="color:#666; margin-bottom:20px;">DoÄŸrulama baÅŸarÄ±lÄ±! Åžimdi giriÅŸ yapÄ±n.</p>

<div style="display:flex; justify-content:center; margin-bottom:10px;">
<div id="g_id_onload"
     data-client_id="897971776455-eh0lpcnpcecifps2kga7lqrh2r6o8ole.apps.googleusercontent.com"
     data-callback="onSignIn">
</div>
<div class="g_id_signin"
     data-type="standard"
     data-theme="filled_black"
     data-width="280">
</div>
</div>

<div style="margin:15px 0; color:#444; font-size:12px;">VEYA</div>

<button onclick="enterAsGuest()"
style="background:transparent; border:1px solid #444; width:280px; padding:10px; color:#aaa; border-radius:5px;">
Misafir Olarak Devam Et
</button>
</div>
</div>
</div>

<div id="main-app">
<div id="header">
<div style="font-weight:bold; color:var(--primary);">
NEURA MAX <span id="u-tag" style="color:#555; font-size:11px;"></span>
</div>
</div>

<div id="chat"></div>

<div id="status-container" style="padding: 0 20px;"></div>

<div id="input-area">
<input id="q" placeholder="Ä°nternette herhangi bir ÅŸey ara..." autocomplete="off">
<button onclick="talk()">GÃ–NDER</button>
</div>
</div>

<script>
let isVerified = false;
let isLoading = false;
const TAVILY_KEY = "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"; // Tavily API AnahtarÄ±n

/* CAPTCHA - DokunulmadÄ± */
window.unlock = (token) => {
if (!token) return;
isVerified = true;
document.getElementById("captcha-box").classList.add("hidden");
document.getElementById("login-options").classList.remove("hidden");
};

/* GOOGLE LOGIN - DokunulmadÄ± */
window.onSignIn = (resp) => {
try {
if (!resp.credential) return;
const payload = JSON.parse(atob(resp.credential.split('.')[1]));
if (!payload.name) throw new Error();
enterApp(payload.name, "Google");
} catch {
alert("Google doÄŸrulama baÅŸarÄ±sÄ±z.");
}
};

window.enterAsGuest = () => {
if (!isVerified) {
alert("Ã–nce captcha doÄŸrulamasÄ± yapmalÄ±sÄ±n.");
return;
}
enterApp("Misafir", "Guest");
};

function enterApp(name, provider) {
document.getElementById("auth-overlay").style.display = "none";
document.getElementById("main-app").style.display = "flex";
document.getElementById("u-tag").textContent = "| " + provider;
add("HoÅŸ geldin " + name + " ðŸ‘‹ Ä°nternette senin iÃ§in ne araÅŸtÄ±rmamÄ± istersin?", "bot");
}

/* YENÄ° NESÄ°L AKILLI ARAMA (TAVILY) */
async function talk() {
if (isLoading) return;

const input = document.getElementById("q");
const statusContainer = document.getElementById("status-container");
const txt = input.value.trim();
if (!txt) return;

isLoading = true;
input.value = "";
add(txt, "user");

// "AranÄ±yor..." yazÄ±sÄ±nÄ± Ã§Ä±karÄ±yoruz ðŸ”
const statusDiv = document.createElement("div");
statusDiv.className = "searching";
statusDiv.innerHTML = "AranÄ±yor... ðŸ”";
statusContainer.appendChild(statusDiv);

try {
const r = await fetch("https://api.tavily.com/search", {
method:"POST",
headers:{ "Content-Type":"application/json" },
body:JSON.stringify({
api_key: TAVILY_KEY,
query: txt,
search_depth: "smart",
include_answer: true
})
});

const d = await r.json();
statusDiv.remove(); // Arama bitince yazÄ±yÄ± kaldÄ±r

if (d.answer) {
add(d.answer, "bot");
} else if (d.results && d.results.length > 0) {
add(d.results[0].content, "bot");
} else {
add("ÃœzgÃ¼nÃ¼m kanka, buna dair bir sonuÃ§ bulamadÄ±m. âœ¨", "bot");
}

} catch (err) {
statusDiv.remove();
add("â— Ä°nternet taramasÄ± sÄ±rasÄ±nda bir hata oluÅŸtu.", "bot");
console.error(err);
}

isLoading = false;
}

function add(t, c) {
const div = document.createElement("div");
div.className = "msg " + c;
div.textContent = t;
const box = document.getElementById("chat");
box.appendChild(div);
box.scrollTop = box.scrollHeight;
return div;
}

document.getElementById("q").addEventListener("keydown", e=>{
if(e.key==="Enter") talk();
});
</script>

</body>
</html>
